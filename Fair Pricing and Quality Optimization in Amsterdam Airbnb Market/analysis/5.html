<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Part 4: Modeling for Renters and Hosts – Fair Pricing and Quality Optimization in Amsterdam’s Airbnb Market</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-9ea0a49c779b6fc496fdb60b6bf00fef.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b42cd826e5e3b4a7d83aac9c9e282496.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analysis/index.html">Analysis</a></li><li class="breadcrumb-item"><a href="../analysis/5.html">Part 4: Modeling for Renters and Hosts</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/air.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/ShihangHeisenberg" title="Shihang" class="quarto-navigation-tool px-1" aria-label="Shihang"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../analysis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 0: Tech Map</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 1: Collecting Data for Factor Inventories</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 2: Preliminarily Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 3: Features Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Part 4: Modeling for Renters and Hosts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Achievement Presentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 5: Modeling for Renters and HostsFor the Government</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#for-renters" id="toc-for-renters" class="nav-link active" data-scroll-target="#for-renters">4.1 For Renters</a></li>
  <li><a href="#for-hosts" id="toc-for-hosts" class="nav-link" data-scroll-target="#for-hosts">4.2 For Hosts</a></li>
  <li><a href="#performance" id="toc-performance" class="nav-link" data-scroll-target="#performance">4.3 Performance</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analysis/index.html">Analysis</a></li><li class="breadcrumb-item"><a href="../analysis/5.html">Part 4: Modeling for Renters and Hosts</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Part 4: Modeling for Renters and Hosts</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="116743a9-c4ea-4745-9582-5704c4aabc34" class="cell" data-tags="[]" data-results="hide" data-execution_count="1">
<div class="cell-output cell-output-display">
<script type="application/javascript">
(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.2.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = false;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["jspanel"], function(jsPanel) {
    window.jsPanel = jsPanel
    on_load()
      })
      require(["jspanel-modal"], function() {
    on_load()
      })
      require(["jspanel-tooltip"], function() {
    on_load()
      })
      require(["jspanel-hint"], function() {
    on_load()
      })
      require(["jspanel-layout"], function() {
    on_load()
      })
      require(["jspanel-contextmenu"], function() {
    on_load()
      })
      require(["jspanel-dock"], function() {
    on_load()
      })
      require(["gridstack"], function(GridStack) {
    window.GridStack = GridStack
    on_load()
      })
      require(["notyf"], function() {
    on_load()
      })
      root._bokeh_is_loading = css_urls.length + 9;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
    existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
    on_load()
    continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.1/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.1/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.1/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.1/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.1/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.1/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.1/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.1/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.1/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
    existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
    if (!window.requirejs) {
      on_load();
    }
    continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
    if (!window.requirejs) {
      on_load();
    }
    continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
    if (!window.requirejs) {
      on_load();
    }
    continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-3.2.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.2.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.2.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.2.1.min.js", "https://cdn.holoviz.org/panel/1.2.1/dist/panel.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
    var NewBokeh = root.Bokeh;
    if (Bokeh.versions === undefined) {
      Bokeh.versions = new Map();
    }
    if (NewBokeh.version !== Bokeh.version) {
      Bokeh.versions.set(NewBokeh.version, NewBokeh)
    }
    root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
    root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
    console.debug("Bokeh: BokehJS plotting callback run at", now());
    run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/javascript">

if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}

</script>
</div>
<div class="cell-output cell-output-display">
<style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style>
</div>
<div class="cell-output cell-output-display">

<div class="logo-block">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAAB+wAAAfsBxc2miwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA6zSURB
VHic7ZtpeFRVmsf/5966taWqUlUJ2UioBBJiIBAwCZtog9IOgjqACsogKtqirT2ttt069nQ/zDzt
tI4+CrJIREFaFgWhBXpUNhHZQoKBkIUASchWla1S+3ar7r1nPkDaCAnZKoQP/D7mnPOe9/xy76n3
nFSAW9ziFoPFNED2LLK5wcyBDObkb8ZkxuaoSYlI6ZcOKq1eWFdedqNzGHQBk9RMEwFAASkk0Xw3
ETacDNi2vtvc7L0ROdw0AjoSotQVkKSvHQz/wRO1lScGModBFbDMaNRN1A4tUBCS3lk7BWhQkgpD
lG4852/+7DWr1R3uHAZVQDsbh6ZPN7CyxUrCzJMRouusj0ipRwD2uKm0Zn5d2dFwzX1TCGhnmdGo
G62Nna+isiUqhkzuKrkQaJlPEv5mFl2fvGg2t/VnzkEV8F5ioioOEWkLG86fvbpthynjdhXYZziQ
x1hC9J2NFyi8vCTt91Fh04KGip0AaG9zuCk2wQCVyoNU3Hjezee9bq92duzzTmxsRJoy+jEZZZYo
GTKJ6SJngdJqAfRzpze0+jHreUtPc7gpBLQnIYK6BYp/uGhw9YK688eu7v95ysgshcg9qSLMo3JC
4jqLKQFBgdKDPoQ+Pltb8dUyQLpeDjeVgI6EgLIQFT5tEl3rn2losHVsexbZ3EyT9wE1uGdkIPcy
BGxn8QUq1QrA5nqW5i2tLqvrrM9NK6AdkVIvL9E9bZL/oyfMVd/jqvc8LylzRBKDJSzIExwhQzuL
QYGQj4rHfFTc8mUdu3E7yoLtbTe9gI4EqVgVkug2i5+uXGo919ixbRog+3fTbQ8qJe4ZOYNfMoTI
OoshUNosgO60AisX15aeI2PSIp5KiFLI9ubb1vV3Qb2ltwLakUCDAkWX7/nHKRmmGIl9VgYsUhJm
2NXjKYADtM1ygne9QQDIXlk49FBstMKx66D1v4+XuQr7vqTe0VcBHQlRWiOCbmmSYe2SqtL6q5rJ
zsTb7lKx3FKOYC4DoqyS/B5bvLPxvD9Qtf6saxYLQGJErmDOdOMr/zo96km1nElr8bmPOBwI9COv
HnFPRIwmkSOv9kcAS4heRsidOkpeWBgZM+UBrTFAXNYL5Vf2ii9c1trNzpYdaoVil3WIc+wdk+gQ
noie3ecCcxt9ITcLAPWt/laGEO/9U6PmzZkenTtsSMQ8uYywJVW+grCstAvCIaAdArAsIWkRDDs/
KzLm2YcjY1Lv0UdW73HabE9n6V66cxSzfEmuJssTpKGVp+0vHq73FwL46eOjpMpbRAnNmJFrGJNu
Ukf9Yrz+3rghiumCKNXXWPhLYcjxGsIpoCMsIRoFITkW8AuyM8jC1+/QLx4bozCEJIq38+1rtpR6
V/yzb8eBlRb3fo5l783N0CWolAzJHaVNzkrTzlEp2bQ2q3TC5gn6wpnoQAmwSiGh2GitnTmVMc5O
UyfKWUKCIsU7+fZDKwqdT6DDpvkzAX4/+AMFjk0tDp5GRXLpQ2MUmhgDp5gxQT8+Y7hyPsMi8uxF
71H0oebujHALECjFKaW9Lm68n18wXp2kVzIcABytD5iXFzg+WVXkegpAsOOYziqo0OkK76GyquC3
ltZAzMhhqlSNmmWTE5T6e3IN05ITFLM4GdN0vtZ3ob8Jh1NAKXFbm5PtLU/eqTSlGjkNAJjdgn/N
aedXa0tdi7+t9G0FIF49rtMSEgAs1kDLkTPO7ebm4IUWeyh1bKomXqlgMG6kJmHcSM0clYLJ8XtR
1GTnbV3F6I5wCGikAb402npp1h1s7LQUZZSMIfALFOuL3UUrfnS8+rez7v9qcold5tilgHbO1fjK
9ubb17u9oshxzMiUBKXWqJNxd+fqb0tLVs4lILFnK71H0Ind7uiPgACVcFJlrb0tV6DzxqqTIhUM
CwDf1/rrVhTa33/3pGPxJYdQ2l2cbgVcQSosdx8uqnDtbGjh9SlDVSMNWhlnilfqZk42Th2ZpLpf
xrHec5e815zrr0dfBZSwzkZfqsv+1FS1KUknUwPARVvItfKUY+cn57yP7qv07UE3p8B2uhUwLk09
e0SCOrK+hbdYHYLjRIl71wWzv9jpEoeOHhGRrJAzyEyNiJuUqX0g2sBN5kGK6y2Blp5M3lsB9Qh4
y2Ja6x6+i0ucmKgwMATwhSjdUu49tKrQ/pvN5d53ml2CGwCmJipmKjgmyuaXzNeL2a0AkQ01Th5j
2DktO3Jyk8f9vcOBQHV94OK+fPumJmvQHxJoWkaKWq9Vs+yUsbq0zGT1I4RgeH2b5wef7+c7bl8F
eKgoHVVZa8ZPEORzR6sT1BzDUAD/d9F78e2Tzv99v8D+fLVTqAKAsbGamKey1Mt9Ann4eH3gTXTz
idWtAJ8PQWOk7NzSeQn/OTHDuEikVF1R4z8BQCy+6D1aWRfY0tTGG2OM8rRoPaeIj5ZHzJxszElN
VM8K8JS5WOfv8mzRnQAKoEhmt8gyPM4lU9SmBK1MCQBnW4KONT86v1hZ1PbwSXPw4JWussVjtH9Y
NCoiL9UoH/6PSu8jFrfY2t36erQHXLIEakMi1SydmzB31h3GGXFDFNPaK8Rme9B79Ixrd0WN+1ij
NRQ/doRmuFLBkHSTOm5GruG+pFjFdAmorG4IXH1Qua6ASniclfFtDYt+oUjKipPrCQB7QBQ2lrgP
fFzm+9XWUtcqJ3/5vDLDpJ79XHZk3u8nGZ42qlj1+ydtbxysCezrydp6ugmipNJ7WBPB5tydY0jP
HaVNzs3QzeE4ZpTbI+ZbnSFPbVOw9vsfnVvqWnirPyCNGD08IlqtYkh2hjZ5dErEQzoNm+6ykyOt
Lt5/PQEuSRRKo22VkydK+vvS1XEKlhCJAnsqvcVvH7f/ZU2R67eXbMEGAMiIV5oWZWiWvz5Fv2xG
sjqNJQRvn3Rs2lji/lNP19VjAQDgD7FHhujZB9OGqYxRkZxixgRDVlqS6uEOFaJUVu0rPFzctrnF
JqijImVp8dEKVWyUXDk92zAuMZ6bFwpBU1HrOw6AdhQgUooChb0+ItMbWJitSo5Ws3IAOGEOtL53
0vHZih9sC4vtofZ7Qu6523V/fmGcds1TY3V36pUsBwAbSlxnVh2xLfAD/IAIMDf7XYIkNmXfpp2l
18rkAJAy9HKFaIr/qULkeQQKy9zf1JgDB2uaeFNGijo5QsUyacNUUTOnGO42xSnv4oOwpDi1zYkc
efUc3I5Gk6PhyTuVKaOGyLUAYPGIoY9Pu/atL/L92+4q9wbflRJ2Trpm/jPjdBtfnqB/dIThcl8A
KG7hbRuKnb8qsQsVvVlTrwQAQMUlf3kwJI24Z4JhPMtcfng5GcH49GsrxJpGvvHIaeem2ma+KSjQ
lIwUdYyCY8j4dE1KzijNnIP2llF2wcXNnsoapw9XxsgYAl6k+KzUXbi2yP3KR2ecf6z3BFsBICdW
nvnIaG3eHybqX7vbpEqUMT+9OL4Qpe8VON7dXuFd39v19FoAABRVePbGGuXTszO0P7tu6lghUonE
llRdrhArLvmKdh9u29jcFiRRkfLUxBiFNiqSU9icoZQHo5mYBI1MBgBH6wMNb+U7Pnw337H4gi1Y
ciWs+uks3Z9fztUvfzxTm9Ne8XXkvQLHNytOOZeiD4e0PgkAIAYCYknKUNUDSXEKzdWNpnil7r4p
xqkjTarZMtk/K8TQ6Qve78qqvXurGwIJqcOUKfUWHsm8KGvxSP68YudXq4pcj39X49uOK2X142O0
Tz5/u/7TVybqH0rSya6ZBwD21/gubbrgWdDgEOx9WUhfBaC2ibcEBYm7a7x+ukrBMNcEZggyR0TE
T8zUPjikQ4VosQZbTpS4vqizBKvqmvjsqnpfzaZyx9JPiz1/bfGKdgD45XB1zoIMzYbfTdS/NClB
Gct0USiY3YL/g0LHy/uq/Ef6uo5+n0R/vyhp17Klpge763f8rMu6YU/zrn2nml+2WtH+Z+5IAAFc
2bUTdTDOSNa9+cQY7YLsOIXhevEkCvzph7a8laecz/Un/z4/Ae04XeL3UQb57IwU9ZDr9UuKVajv
nxp1+1UVIo/LjztZkKH59fO3G/JemqCfmaCRqbqbd90ZZ8FfjtkfAyD0J/9+C2h1hDwsSxvGjNDc
b4zk5NfrSwiQblLHzZhg+Jf4aPlUwpDqkQqa9nimbt1/TDH8OitGMaQnj+RJS6B1fbF7SY1TqO5v
/v0WAADl1f7zokgS7s7VT2DZ7pegUjBM7mjtiDZbcN4j0YrHH0rXpCtY0qPX0cVL0rv5jv/ZXend
0u/EESYBAFBU4T4Qa5TflZOhTe7pmKpaP8kCVUVw1+yhXfJWvn1P3hnXi33JsTN6PnP3hHZ8Z3/h
aLHzmkNPuPj7Bc/F/Q38CwjTpSwQXgE4Vmwry9tpfq/ZFgqFMy4AVDtCvi8rvMvOmv0N4YwbVgEA
sPM72/KVnzfspmH7HQGCRLG2yL1+z8XwvPcdCbsAANh+xPzstgMtxeGKt+6MK3/tacfvwhWvIwMi
oKEBtm0H7W+UVfkc/Y1V0BhoPlDr/w1w/eu1vjIgAgDg22OtX6/eYfnEz/focrZTHAFR+PSs56/7
q32nwpjazxgwAQCwcU/T62t3WL7r6/jVRa6/byp1rei+Z98ZUAEAhEPHPc8fKnTU9nbgtnOe8h0l
9hcGIqmODLQAHCy2Xti6v/XNRivf43f4fFvIteu854+VHnR7q9tfBlwAAGz+pnndB9vM26UebAe8
SLHujPOTPVW+rwY+sxskAAC2HrA8t2Vvc7ffP1r9o+vwR2dcr92InIAbKKC1FZ5tB1tf+/G8p8sv
N/9Q5zd/XR34LYCwV5JdccMEAMDBk45DH243r/X4xGvqxFa/GNpS7n6rwOwNWwHVE26oAADYurf1
zx/utOzt+DMKYM0p17YtZZ5VNzqfsB2HewG1WXE8PoZ7gOclbTIvynZf9JV+fqZtfgs/8F/Nu5rB
EIBmJ+8QRMmpU7EzGRsf2FzuePqYRbzh/zE26EwdrT10f6r6o8HOYzCJB9Dpff8tbnGLG8L/A/WE
roTBs2RqAAAAAElFTkSuQmCC" style="height:25px; border-radius:12px; display: inline-block; float: left; vertical-align: middle">


  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAK6wAACusBgosNWgAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAf9SURBVFiFvZh7cFTVHcc/59y7793sJiFAwkvAYDRqFWwdraLVlj61diRYsDjqCFbFKrYo0CltlSq1tLaC2GprGIriGwqjFu10OlrGv8RiK/IICYECSWBDkt3s695zTv9IAtlHeOn0O7Mzu797z+/3Ob/z+p0VfBq9doNFljuABwAXw2PcvGHt6bgwxhz7Ls4YZNVXxxANLENwE2D1W9PAGmAhszZ0/X9gll5yCbHoOirLzmaQs0F6F8QMZq1v/8xgNm7DYwwjgXJLYL4witQ16+sv/U9HdDmV4WrKw6B06cZC/RMrM4MZ7xz61DAbtzEXmAvUAX4pMOVecg9/MFFu3j3Gz7gQBLygS2RGumBkL0cubiFRsR3LzVBV1UMk3IrW73PT9C2lYOwhQB4ClhX1AuKpjLcV27oEjyUpNUJCg1CvcejykWTCXyQgzic2HIIBjg3pS6+uRLKAhumZvD4U+tq0jTrgkVKQQtLekfTtxIPAkhTNF6G7kZm7aPp6M9myKVQEoaYaIhEQYvD781DML/RfBGNZXAl4irJiwBa07e/y7cQnBaJghIX6ENl2GR/fGCBoz6cm5qeyEqQA5ZYA5x5eeiV0Qph4gjFAUSwAr6QllQgcxS/Jm25Cr2Tmpsk03XI9NfI31FTZBEOgVOk51adqDBNPCNPSRlkiDXbBEwOU2WxH+I7itQZ62g56OjM33suq1YsZHVtGZSUI2QdyYgkgOthQNIF7BIGDnRAJgJSgj69cUx1gB8PkOGwL4E1gPrM27gIg7NlGKLQApc7BmEnAxP5g/rw4YqBrCDB5xHkw5rdR/1qTrN/hKNo6YUwVDNpFsnjYS8RbidBPcPXFP6R6yfExuOXmN4A3jv1+8ZUwgY9D2OWjUZE6lO88jDwHI8ZixGiMKSeYTBamCoDk6kDAb6y1OcH1a6KpD/fZesoFw5FlIXAVCIiH4PxrV+p2npVDToTBmtjY8t1swh2V61E9KqWiyuPEjM8dbfxuvfa49Zayf9R136Wr8mBSf/T7bNteA8zwaGEUbFpckWwq95n59dUIywKl2fbOIS5e8bWSu0tJ1a5redAYfqkdjesodFajcgaVNWhXo1C9SrkN3Usmv3UMJrc6/DDwkwEntkEJLe67tSLhvyzK8rHDQWleve5CGk4VZEB1r+5bg2E2si+Y0QatDK6jUVkX5eg2YYlp++ZM+rfMNYamAj8Y7MAVWFqaR1f/t2xzU4IHjybBtthzuiAASqv7jTF7jOqDMAakFHgDNsFyP+FhwZHBmH9F7cutIYkQCylYYv1AZSqsn1/+bX51OMMjPSl2nAnM7hnjOx2v53YgNWAzHM9Q/9l0lQWPSCBSyokAtOBC1Rj+w/1Xs+STDp4/E5g7Rs2zm2+oeVd7PUuHKDf6A4r5EsPT5K3gfCnBXNUYnvGzb+KcCczYYWOnLpy4eOXuG2oec0PBN8XQQAnpvS35AvAykr56rWhPBiV4MvtceGLxk5Mr6A1O8IfK7rl7xJ0r9kyumuP4fa0lMqTBLJIAJqEf1J3qE92lMBndlyfRD2YBghHC4hlny7ASqCeWo5zaoDdIWfnIefNGTb9fC73QDfhyBUCNOxrGPSUBfPem9us253YTV+3mcBbdkUYfzmHiLqZbYdIGHHON2ZlemXouaJUOO6TqtdHEQuXYY8Yt+EbDgmlS6RdzkaDTv2P9A3gICiq93sWhb5mc5wVhuU3Y7m5hOc3So7qFT3SLgOXHb/cyOfMn7xROegoC/PTcn3v8gbKPgDopJFk3R/uBPWQiwQ+2/GJevRMObLUzqe/saJjQUQTTftEVMW9tWxPgAocwcj9abNcZe7s+6t2R2xXZG7zyYLp8Q1PiRBBHym5bYuXi8Qt+/LvGu9f/5YDAxABsaRNPH6Xr4D4Sk87a897SOy9v/fKwjoF2eQel95yDESGEF6gEMwKhLwKus3wOVjTtes7qzgLdXTMnNCNoEpbcrtNuq6N7Xh/+eqcbj94xQkp7mdKpW5XbtbR8Z26kgMCAf2UU5YEovRUVRHbu2b3vK1UdDFkDCyMRQxbpdv8nhKAGIa7QaQedzT07fFPny53R738JoVYBdVrnsNx9XZ9v33UeGO+AA2MMUkgqQ5UcdDLZSFeVgONnXeHqSAC5Ew1BXwko0D1Zct3dT1duOjS3MzZnEUJtBuoQAq3SGOLR4ekjn9NC5nVOaYXf9lETrUkmOJy3pOz8OKIb2A1cWhJCCEzOxU2mUPror+2/L3yyM3pkM7jTjr1nBOgkGeyQ7erxpdJsMAS9wb2F9rzMxNY1K2PMU0WtZV82VU8Wp6vbKJVo9Lx/+4cydORdxCCQ/kDGTZCWsRpLu7VD7bfKqL8V2orKTp/PtzaXy42jr6TwAuisi+7JolUG4wY+8vyrISCMtRrLKWpvjAOqx/QGhp0rjRo5xD3x98CWQuOQN8qumRMmI7jKZPUEpzNVZsj4Zbaq1to5tZZsKIydLWojhIXrJnES79EaOzv3du2NytKuxzJKAA6wF8xqEE8s2jo/1wd/khslQGxd81Zg62Bbp31XBH+iETt7Y3ELA0iU6iGDlQ5mexe0VEx4a3x8V1AaYwFJgTiwaOsDmeK2J8nMUOqsnB1A+dcA04ucCYt0urkjmflk9iT2v30q/gZn5rQPvor4n9Ou634PeBzoznes/iot/7WnClKoM/+zCIjH5kwT8ChQjTHPIPTjFV3PpU/Hx+DM/A9U3IXI4SPCYAAAAABJRU5ErkJggg==" style="height:15px; border-radius:12px; display: inline-block; float: left">
  




</div>
</div>
</div>
<div id="8405d5b8-7834-42c6-be2d-e19d88f08239" class="cell" data-results="hide" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add geo-features</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Am_Basic <span class="op">=</span> gpd.GeoDataFrame(pd.DataFrame(Am_Basic))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Am_Basic1 <span class="op">=</span> gpd.sjoin(Am_Basic, Am_Area, how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Am_Basic1 <span class="op">=</span> Am_Basic1.rename(columns<span class="op">=</span>{<span class="st">"Gebied"</span>: <span class="st">"area"</span>})</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Am_Basic1 <span class="op">=</span> Am_Basic1.drop(columns<span class="op">=</span>[<span class="st">'index_right'</span>])</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Am_Basic2 <span class="op">=</span> gpd.sjoin(Am_Basic1, Am_District, how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Am_Basic2 <span class="op">=</span> Am_Basic2.rename(columns<span class="op">=</span>{<span class="st">"Stadsdeelcode"</span>: <span class="st">"district"</span>})</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>Am_Basic2 <span class="op">=</span> Am_Basic2.drop(columns<span class="op">=</span>[<span class="st">'index_right'</span>])</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Am_Basic3 <span class="op">=</span> gpd.sjoin(Am_Basic2, Am_Quarter, how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>Am_Basic3 <span class="op">=</span> Am_Basic3.rename(columns<span class="op">=</span>{<span class="st">"CBS_Wijkcode"</span>: <span class="st">"quarter"</span>})</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>Am_Basic3 <span class="op">=</span> Am_Basic3.drop(columns<span class="op">=</span>[<span class="st">'index_right'</span>])</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>Am_Basic4 <span class="op">=</span> gpd.sjoin(Am_Basic3, Am_Neighborhood, how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>Am_Basic4 <span class="op">=</span> Am_Basic4.rename(columns<span class="op">=</span>{<span class="st">"CBS_Buurtcode"</span>: <span class="st">"neighborhood"</span>})</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>Am_Basic4 <span class="op">=</span> Am_Basic4.drop(columns<span class="op">=</span>[<span class="st">'index_right'</span>])</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>Am_Basic4 <span class="op">=</span> Am_Basic4.dropna()</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>Am_Basic4 <span class="op">=</span> Am_Basic4[(Am_Basic4[<span class="st">'price'</span>] <span class="op">&lt;</span> <span class="dv">3000</span>) <span class="op">&amp;</span> (Am_Basic4[<span class="st">'price'</span>] <span class="op">&gt;=</span> <span class="dv">20</span>)]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>Am_geo <span class="op">=</span> Am_Basic4[[<span class="st">"geometry"</span>]]</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> Am_Basic1, Am_Basic2, Am_Basic3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>All the model are for predicting the most generalizable, reasonable, while still accurate outcomes of each model. So here we should get rid of exorbitant objects of each training lists. To fully improve the model’s generalizability, accountability, and accuracy. We further adopt lag features, iterations, and selection of reasonable variables (variables that are causal and controllable by different subjects).</p>
<p>What’s more, to combine different training set that are interrelated but with quite different number of objects that cause the model larger than <strong>72 GB</strong> and will crush the program, I trained housing information set first to get preliminary potential variables and then trained the order information set to ensure the final model fits well to all those sets. In this process, I conducted extensive attempts to get the most potential variables with the best parameters to obtain the model with the highest accountability, accuracy and significance.</p>
<p>Here is the technology map of the modeling process. All the training and test sets are 7:3 divided.</p>
<div id="e5a7a032-4040-45fe-bd18-726b5ac43eaa" class="cell" data-results="hide" data-execution_count="56">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>display(Image(filename<span class="op">=</span><span class="st">"New folder/Untitled-1-01.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="for-renters" class="level3">
<h3 class="anchored" data-anchor-id="for-renters">4.1 For Renters</h3>
<p>This model is for renters to find price reference. Just by inputting the requirement, date of checking in and clicking on the map to find a preferred location, they can get a fair price according to the real-time market situation. They can avoid being overcharged or malserviced. These variables can be further classified into different level like economic choice, prime choice, luxury choice as preset options. These model shows a large commercial and market surveillance potential. To further explore the model. I introduced in time and spatial lag, and error lag for potential sequential influence.</p>
<section id="modeling" class="level4">
<h4 class="anchored" data-anchor-id="modeling">4.1.1 Modeling</h4>
<div id="f689e455-e6ac-4ec0-ba50-4ece0b87102a" class="cell" data-results="hide" data-execution_count="57">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Am_Time_B[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(Am_Time_B[<span class="st">'date'</span>])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>diffdate <span class="op">=</span> (</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    Am_Time_B[[<span class="st">'listing_id'</span>, <span class="st">'date'</span>]]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'listing_id'</span>, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    .agg(diffday<span class="op">=</span>(<span class="st">'date'</span>, <span class="kw">lambda</span> x: (x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>()).days))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="f4ab8e5c-41ff-4f24-b9ca-2b2484479efe" class="cell" data-results="hide" data-execution_count="58">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for renters,they care more about the difference between the should-be price and the real price.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># location, attribute, hosts' experience, time </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Am_Time_B[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(Am_Time_B[<span class="st">'date'</span>])</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>diffdate <span class="op">=</span> (</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    Am_Time_B[[<span class="st">'listing_id'</span>, <span class="st">'date'</span>]]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'listing_id'</span>, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    .agg(diffday<span class="op">=</span>(<span class="st">'date'</span>, <span class="kw">lambda</span> x: (x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>()).days))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>diffdate.rename(columns<span class="op">=</span>{<span class="st">'listing_id'</span>: <span class="st">'id'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>diffdate[<span class="st">'diffday'</span>] <span class="op">=</span> diffdate[<span class="st">'diffday'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>diffdate <span class="op">=</span> diffdate[diffdate[<span class="st">'diffday'</span>] <span class="op">&gt;=</span> <span class="dv">30</span>]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>Am_geometry <span class="op">=</span> Am_Basic5[Am_Basic5[<span class="st">'price'</span>] <span class="op">&lt;=</span> <span class="dv">1000</span>][[<span class="st">'geometry'</span>]]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>Am_Basic5 <span class="op">=</span> Am_Basic5[Am_Basic5[<span class="st">'price'</span>] <span class="op">&lt;=</span> <span class="dv">1000</span>]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="op">=</span> [</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="st">'host_is_superhost'</span>,<span class="st">'property_type'</span>,<span class="st">'accommodates'</span>,<span class="st">'bathrooms'</span>,<span class="st">'bedrooms'</span>,<span class="st">'beds'</span>,<span class="st">'bed_type'</span>,<span class="st">'first_review'</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="st">'review_scores_rating'</span>,<span class="st">'review_scores_accuracy'</span>,<span class="st">'review_scores_cleanliness'</span>,<span class="st">'review_scores_checkin'</span>,<span class="st">'review_scores_communication'</span>,<span class="st">'review_scores_location'</span>,<span class="st">'review_scores_value'</span>,<span class="st">'a1'</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="st">'a2'</span>,<span class="st">'a3'</span>,<span class="st">'a4'</span>,<span class="st">'a5'</span>,<span class="st">'a6'</span>,<span class="st">'a7'</span>,<span class="st">'a8'</span>,<span class="st">'a9'</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="st">'a10'</span>,<span class="st">'a11'</span>,<span class="st">'a12'</span>,<span class="st">'a13'</span>,<span class="st">'a14'</span>,<span class="st">'a15'</span>,<span class="st">'a16'</span>,<span class="st">'a17'</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="st">'a18'</span>,<span class="st">'a19'</span>,<span class="st">'a20'</span>,<span class="st">'a21'</span>,<span class="st">'a22'</span>,<span class="st">'a23'</span>,<span class="st">'a24'</span>,<span class="st">'a25'</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="st">'a26'</span>,<span class="st">'a27'</span>,<span class="st">'a28'</span>,<span class="st">'a29'</span>,<span class="st">'a30'</span>,<span class="st">'a31'</span>,<span class="st">'a32'</span>,<span class="st">'a33'</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="st">'a34'</span>,<span class="st">'a35'</span>,<span class="st">'a36'</span>,<span class="st">'a37'</span>,<span class="st">'a38'</span>,<span class="st">'a39'</span>,<span class="st">'a40'</span>,<span class="st">'a41'</span>,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="st">'a42'</span>,<span class="st">'a43'</span>,<span class="st">'a44'</span>,<span class="st">'a45'</span>,<span class="st">'a46'</span>,<span class="st">'a47'</span>,<span class="st">'a48'</span>,<span class="st">'a49'</span>,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="st">'a50'</span>,<span class="st">'a51'</span>,<span class="st">'a52'</span>,<span class="st">'a53'</span>,<span class="st">'a54'</span>,<span class="st">'a55'</span>,<span class="st">'a56'</span>,<span class="st">'a57'</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="st">'a58'</span>,<span class="st">'a59'</span>,<span class="st">'a60'</span>,<span class="st">'a61'</span>,<span class="st">'a62'</span>,<span class="st">'a63'</span>,<span class="st">'a64'</span>,<span class="st">'a65'</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="st">'a66'</span>,<span class="st">'a67'</span>,<span class="st">'a68'</span>,<span class="st">'a69'</span>,<span class="st">'a70'</span>,<span class="st">'a71'</span>,<span class="st">'a72'</span>,<span class="st">'a73'</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="st">'a74'</span>,<span class="st">'a75'</span>,<span class="st">'a76'</span>,<span class="st">'a77'</span>,<span class="st">'a78'</span>,<span class="st">'a79'</span>,<span class="st">'a80'</span>,<span class="st">'a81'</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="st">'a82'</span>,<span class="st">'a83'</span>,<span class="st">'a84'</span>,<span class="st">'a85'</span>,<span class="st">'a86'</span>,<span class="st">'a87'</span>,<span class="st">'a88'</span>,<span class="st">'a89'</span>,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="st">'a90'</span>,<span class="st">'a91'</span>,<span class="st">'a92'</span>,<span class="st">'a93'</span>,<span class="st">'a94'</span>,<span class="st">'a95'</span>,<span class="st">'a96'</span>,<span class="st">'a97'</span>,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="st">'a98'</span>,<span class="st">'a99'</span>,<span class="st">'a100'</span>,<span class="st">'a101'</span>,<span class="st">'a102'</span>,<span class="st">'a103'</span>,<span class="st">'a104'</span>,<span class="st">'a105'</span>,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="st">'a106'</span>,<span class="st">'a107'</span>,<span class="st">'a108'</span>,<span class="st">'a109'</span>,<span class="st">'a110'</span>,<span class="st">'a111'</span>,<span class="st">'a112'</span>,<span class="st">'a113'</span>,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="st">'a114'</span>,<span class="st">'a115'</span>,<span class="st">'a116'</span>,<span class="st">'a117'</span>,<span class="st">'a118'</span>,<span class="st">'a119'</span>,<span class="st">'room_type'</span>,<span class="st">'price'</span>,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="st">'number_of_reviews'</span>,<span class="st">'last_review'</span>,<span class="st">'reviews_per_month'</span>,<span class="st">'area'</span>,<span class="st">'district'</span>,<span class="st">'quarter'</span>,<span class="st">'neighborhood'</span>,<span class="st">'shops_nn1'</span>,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="st">'shops_nn2'</span>,<span class="st">'shops_nn3'</span>,<span class="st">'shops_nn4'</span>,<span class="st">'shops_nn5'</span>,<span class="st">'playground_nn1'</span>,<span class="st">'playground_nn2'</span>,<span class="st">'playground_nn3'</span>,<span class="st">'playground_nn4'</span>,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="st">'playground_nn5'</span>,<span class="st">'station_nn1'</span>,<span class="st">'station_nn2'</span>,<span class="st">'station_nn3'</span>,<span class="st">'station_nn4'</span>,<span class="st">'station_nn5'</span>,<span class="st">'playfacilities_nn1'</span>,<span class="st">'playfacilities_nn2'</span>,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="st">'playfacilities_nn3'</span>,<span class="st">'playfacilities_nn4'</span>,<span class="st">'playfacilities_nn5'</span>,<span class="st">'sightseeing_nn1'</span>,<span class="st">'sightseeing_nn2'</span>,<span class="st">'sightseeing_nn3'</span>,<span class="st">'sightseeing_nn4'</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="st">'sightseeing_nn5'</span>,<span class="st">'food_nn1'</span>,<span class="st">'food_nn2'</span>,<span class="st">'food_nn3'</span>,<span class="st">'food_nn4'</span>,<span class="st">'food_nn5'</span>,<span class="st">'sex_nn1'</span>,<span class="st">'sex_nn2'</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="st">'sex_nn3'</span>,<span class="st">'sex_nn4'</span>,<span class="st">'sex_nn5'</span>,<span class="st">'pub_nn1'</span>,<span class="st">'pub_nn2'</span>,<span class="st">'pub_nn3'</span>,<span class="st">'pub_nn4'</span>,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="st">'pub_nn5'</span>,<span class="st">'walk'</span>,<span class="st">'shopdist'</span>,<span class="st">'protectdist'</span>,<span class="st">'poordist'</span>,<span class="st">'shopping'</span>,<span class="st">'protect'</span>,<span class="st">'poor'</span>,<span class="st">'development'</span>,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="st">'host_response_time'</span>,<span class="st">'host_since'</span>,<span class="st">'host_response_rate'</span>,<span class="st">'host_has_profile_pic'</span>,<span class="st">'host_identity_verified'</span>,<span class="st">'security_deposit'</span>,<span class="st">'cleaning_fee'</span>,<span class="st">'guests_included'</span>,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="st">'extra_people'</span>,<span class="st">'availability_30'</span>,<span class="st">'availability_60'</span>,<span class="st">'availability_90'</span>,<span class="st">'availability_365'</span>,<span class="st">'instant_bookable'</span>,<span class="st">'cancellation_policy'</span>,<span class="st">'require_guest_profile_picture'</span>,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="st">'require_guest_phone_verification'</span>,<span class="st">'id'</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter1 <span class="op">=</span> Am_Basic5[selected_columns]</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter1[<span class="st">'property_type'</span>] <span class="op">=</span> Am_Basic_renter1[<span class="st">'property_type'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">'other'</span> <span class="cf">if</span> x <span class="op">!=</span> <span class="st">'Lighthouse'</span> <span class="cf">else</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="87823753-9c22-4889-ac74-7efa3597c66d" class="cell" data-results="hide" data-execution_count="59">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spatial price Lag</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>coords <span class="op">=</span> np.array(<span class="bu">list</span>(Am_geometry.geometry.<span class="bu">apply</span>(<span class="kw">lambda</span> geom: (geom.x, geom.y))))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> NearestNeighbors(n_neighbors<span class="op">=</span><span class="dv">8</span>).fit(coords)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>distances, indices <span class="op">=</span> knn.kneighbors(coords)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>neighbors_dict <span class="op">=</span> {i: <span class="bu">list</span>(indices[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(indices.shape[<span class="dv">0</span>])}</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>spatialWeights <span class="op">=</span> W(neighbors_dict)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter1[<span class="st">'lagPrice'</span>] <span class="op">=</span> lag_spatial(spatialWeights, Am_Basic_renter1[<span class="st">'price'</span>].values)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>columns_to_select <span class="op">=</span> [</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="st">'host_is_superhost'</span>, <span class="st">'accommodates'</span>, <span class="st">'bathrooms'</span>, <span class="st">'bedrooms'</span>, <span class="st">'beds'</span>, <span class="st">'first_review'</span>, <span class="st">'review_scores_rating'</span>, <span class="st">'review_scores_cleanliness'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="st">'review_scores_checkin'</span>, <span class="st">'review_scores_value'</span>, <span class="st">'a6'</span>, <span class="st">'a10'</span>, <span class="st">'a11'</span>, <span class="st">'a17'</span>, <span class="st">'a18'</span>, <span class="st">'a19'</span>, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="st">'a22'</span>, <span class="st">'a24'</span>, <span class="st">'a26'</span>, <span class="st">'a30'</span>, <span class="st">'a32'</span>, <span class="st">'a36'</span>, <span class="st">'a41'</span>, <span class="st">'a43'</span>, </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="st">'a45'</span>, <span class="st">'a46'</span>, <span class="st">'a48'</span>, <span class="st">'a49'</span>, <span class="st">'a50'</span>, <span class="st">'a51'</span>, <span class="st">'a52'</span>, <span class="st">'a53'</span>, </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="st">'a54'</span>, <span class="st">'a55'</span>, <span class="st">'a56'</span>, <span class="st">'a57'</span>, <span class="st">'a59'</span>, <span class="st">'a60'</span>, <span class="st">'a61'</span>, <span class="st">'a62'</span>, </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="st">'a64'</span>, <span class="st">'a65'</span>, <span class="st">'a67'</span>, <span class="st">'a68'</span>, <span class="st">'a69'</span>, <span class="st">'a70'</span>, <span class="st">'a73'</span>, <span class="st">'a76'</span>, </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="st">'a78'</span>, <span class="st">'a79'</span>, <span class="st">'a83'</span>, <span class="st">'a84'</span>, <span class="st">'a85'</span>, <span class="st">'a88'</span>, <span class="st">'a89'</span>, <span class="st">'a92'</span>, </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="st">'a98'</span>, <span class="st">'a102'</span>, <span class="st">'a103'</span>, <span class="st">'a106'</span>, <span class="st">'a108'</span>, <span class="st">'a110'</span>, <span class="st">'a111'</span>, <span class="st">'a115'</span>, </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="st">'room_type'</span>, <span class="st">'price'</span>, <span class="st">'number_of_reviews'</span>, <span class="st">'last_review'</span>, <span class="st">'reviews_per_month'</span>, <span class="st">'area'</span>, <span class="st">'quarter'</span>, <span class="st">'neighborhood'</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="st">'station_nn5'</span>, <span class="st">'playfacilities_nn4'</span>, <span class="st">'sightseeing_nn2'</span>, <span class="st">'sightseeing_nn3'</span>, <span class="st">'sex_nn1'</span>, <span class="st">'sex_nn2'</span>, <span class="st">'sex_nn3'</span>, <span class="st">'sex_nn4'</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="st">'sex_nn5'</span>, <span class="st">'pub_nn1'</span>, <span class="st">'pub_nn2'</span>, <span class="st">'pub_nn3'</span>, <span class="st">'pub_nn4'</span>, </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="st">'pub_nn5'</span>, <span class="st">'protectdist'</span>, <span class="st">'lagPrice'</span>, <span class="st">'property_type'</span>, <span class="st">'host_response_time'</span>, <span class="st">'host_since'</span>, <span class="st">'host_response_rate'</span>, <span class="st">'host_has_profile_pic'</span>, </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="st">'host_identity_verified'</span>, <span class="st">'security_deposit'</span>, <span class="st">'cleaning_fee'</span>, <span class="st">'guests_included'</span>, <span class="st">'extra_people'</span>, <span class="st">'availability_30'</span>, <span class="st">'availability_60'</span>, <span class="st">'availability_90'</span>, </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="st">'availability_365'</span>, <span class="st">'instant_bookable'</span>, <span class="st">'cancellation_policy'</span>, <span class="st">'require_guest_profile_picture'</span>, <span class="st">'require_guest_phone_verification'</span>, <span class="st">'district'</span>, <span class="st">'id'</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="st">'walk'</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="st">'shopdist'</span>, <span class="st">'protectdist'</span>, <span class="st">'poordist'</span>, <span class="st">'shopping'</span>, <span class="st">'protect'</span>, <span class="st">'poor'</span>, <span class="st">'development'</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="st">'food_nn1'</span>, <span class="st">'food_nn2'</span>, <span class="st">'food_nn3'</span>, <span class="st">'food_nn4'</span>, <span class="st">'food_nn5'</span>, <span class="st">'shops_nn1'</span>, <span class="st">'shops_nn2'</span>, <span class="st">'shops_nn3'</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="st">'shops_nn4'</span>, <span class="st">'shops_nn5'</span>, <span class="st">'playground_nn1'</span>, <span class="st">'playground_nn2'</span>, <span class="st">'playground_nn3'</span>, <span class="st">'playground_nn4'</span>, <span class="st">'playground_nn5'</span>, <span class="st">'station_nn1'</span>, <span class="st">'station_nn2'</span>, <span class="st">'station_nn3'</span>,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="st">'station_nn4'</span>, <span class="st">'station_nn5'</span>, <span class="st">'playfacilities_nn1'</span>, <span class="st">'playfacilities_nn2'</span>, <span class="st">'playfacilities_nn3'</span>, <span class="st">'playfacilities_nn4'</span>, <span class="st">'playfacilities_nn5'</span>, <span class="st">'property_type'</span>, <span class="st">'review_scores_accuracy'</span>, </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="st">'review_scores_communication'</span>, <span class="st">'review_scores_location'</span>, <span class="st">'a1'</span>, <span class="st">'a2'</span>, <span class="st">'a3'</span>, <span class="st">'a4'</span>, <span class="st">'a5'</span>, <span class="st">'a7'</span>, </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="st">'a8'</span>, <span class="st">'a9'</span>, <span class="st">'a12'</span>, <span class="st">'a13'</span>, <span class="st">'a14'</span>, <span class="st">'a15'</span>, <span class="st">'a16'</span>, <span class="st">'a20'</span>,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="st">'a21'</span>, <span class="st">'a23'</span>, <span class="st">'a25'</span>, <span class="st">'a27'</span>, <span class="st">'a28'</span>, <span class="st">'a29'</span>, <span class="st">'a31'</span>, <span class="st">'a33'</span>, </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="st">'a34'</span>, <span class="st">'a35'</span>, <span class="st">'a37'</span>, <span class="st">'a38'</span>, <span class="st">'a39'</span>, <span class="st">'a40'</span>, <span class="st">'a42'</span>, <span class="st">'a44'</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="st">'a47'</span>, <span class="st">'a49'</span>, <span class="st">'a58'</span>, <span class="st">'a63'</span>, <span class="st">'a66'</span>, <span class="st">'a71'</span>, <span class="st">'a72'</span>, <span class="st">'a74'</span>,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="st">'a75'</span>, <span class="st">'a80'</span>, <span class="st">'a81'</span>, <span class="st">'a82'</span>, <span class="st">'a86'</span>, <span class="st">'a87'</span>, <span class="st">'a90'</span>, <span class="st">'a91'</span>,</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="st">'a93'</span>, <span class="st">'a94'</span>, <span class="st">'a95'</span>, <span class="st">'a96'</span>, <span class="st">'a97'</span>, <span class="st">'a99'</span>, <span class="st">'a100'</span>, <span class="st">'a101'</span>,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="st">'a104'</span>, <span class="st">'a105'</span>, <span class="st">'a107'</span>, <span class="st">'a108'</span>, <span class="st">'a109'</span>, <span class="st">'a110'</span>, <span class="st">'a112'</span>, <span class="st">'a113'</span>,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="st">'a114'</span>, <span class="st">'a116'</span>, <span class="st">'a117'</span>, <span class="st">'a118'</span>, <span class="st">'a119'</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter2 <span class="op">=</span> Am_Basic_renter1[columns_to_select]</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter2 <span class="op">=</span> Am_Basic_renter2.loc[:, <span class="op">~</span>Am_Basic_renter2.columns.duplicated()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="68862dd9-f909-41a0-88c3-80ef0a609630" class="cell" data-results="hide" data-execution_count="60">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error Lag</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> Am_Basic_renter2.drop(columns<span class="op">=</span>[<span class="st">"price"</span>])</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> Am_Basic_renter2[<span class="st">"price"</span>]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> X.select_dtypes(include<span class="op">=</span>[<span class="st">"object"</span>, <span class="st">"category"</span>]).columns</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"cat"</span>, OneHotEncoder(drop<span class="op">=</span><span class="st">"first"</span>), categorical_cols)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    remainder<span class="op">=</span><span class="st">"passthrough"</span>  </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Pipeline(steps<span class="op">=</span>[(<span class="st">"preprocessor"</span>, preprocessor), (<span class="st">"regressor"</span>, LinearRegression())])</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>model.fit(X, y)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3<span class="op">=</span>Am_Basic_renter2</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"Price_Predict"</span>] <span class="op">=</span> model.predict(X)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"Price_Error"</span>] <span class="op">=</span> Am_Basic_renter2.<span class="bu">apply</span>(</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> row: <span class="dv">0</span> <span class="cf">if</span> row[<span class="st">"price"</span>] <span class="op">&lt;</span> <span class="dv">1</span> <span class="cf">else</span> row[<span class="st">"Price_Predict"</span>] <span class="op">-</span> row[<span class="st">"price"</span>], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"Price_AE"</span>] <span class="op">=</span> Am_Basic_renter2[<span class="st">"Price_Error"</span>].<span class="bu">abs</span>()</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"Price_APE"</span>] <span class="op">=</span> Am_Basic_renter2[<span class="st">"Price_AE"</span>] <span class="op">/</span> Am_Basic_renter2[<span class="st">"Price_Predict"</span>]</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"Price_PE"</span>] <span class="op">=</span> Am_Basic_renter2[<span class="st">"Price_Error"</span>] <span class="op">/</span> Am_Basic_renter2[<span class="st">"Price_Predict"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="2cf046fc-ee75-4aae-ab61-8826f75864b9" class="cell" data-results="hide" data-execution_count="61">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>neighborList_R_E <span class="op">=</span> KNN.from_array(coords, k<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>spatialWeights_R_E <span class="op">=</span> neighborList_R_E.weights</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>spatialWeights_sparse_R_E <span class="op">=</span> neighborList_R_E.sparse</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"lagError"</span>] <span class="op">=</span> spatialWeights_sparse_R_E <span class="op">@</span> Am_Basic_renter3[<span class="st">"Price_Error"</span>].values</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"lagAE"</span>] <span class="op">=</span> spatialWeights_sparse_R_E <span class="op">@</span> Am_Basic_renter3[<span class="st">"Price_AE"</span>].values</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"lagAPE"</span>] <span class="op">=</span> spatialWeights_sparse_R_E <span class="op">@</span> Am_Basic_renter3[<span class="st">"Price_APE"</span>].values</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"lagPE"</span>] <span class="op">=</span> spatialWeights_sparse_R_E <span class="op">@</span> Am_Basic_renter3[<span class="st">"Price_PE"</span>].values</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter3[<span class="st">"lagpredict"</span>] <span class="op">=</span> spatialWeights_sparse_R_E <span class="op">@</span> Am_Basic_renter3[<span class="st">"Price_Predict"</span>].values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ba586dfe-b17c-4e12-82d5-3e5668e1a589" class="cell" data-results="hide" data-execution_count="62">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="op">=</span> [</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">"host_is_superhost"</span>, <span class="st">"accommodates"</span>, <span class="st">"bathrooms"</span>, <span class="st">"bedrooms"</span>, <span class="st">"first_review"</span>, <span class="st">"review_scores_rating"</span>, <span class="st">"review_scores_cleanliness"</span>, <span class="st">"review_scores_checkin"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">"review_scores_value"</span>, <span class="st">"a6"</span>, <span class="st">"a10"</span>, <span class="st">"a11"</span>, <span class="st">"a18"</span>, <span class="st">"a19"</span>, <span class="st">"a22"</span>, <span class="st">"a24"</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">"a26"</span>, <span class="st">"a32"</span>, <span class="st">"a36"</span>, <span class="st">"a41"</span>, <span class="st">"a43"</span>, <span class="st">"a45"</span>, <span class="st">"a46"</span>, <span class="st">"a49"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">"a50"</span>, <span class="st">"a51"</span>, <span class="st">"a52"</span>, <span class="st">"a53"</span>, <span class="st">"a54"</span>, <span class="st">"a55"</span>, <span class="st">"a56"</span>, <span class="st">"a57"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">"a60"</span>, <span class="st">"a61"</span>, <span class="st">"a64"</span>, <span class="st">"a65"</span>, <span class="st">"a67"</span>, <span class="st">"a68"</span>, <span class="st">"a69"</span>, <span class="st">"a70"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">"a73"</span>, <span class="st">"a76"</span>, <span class="st">"a78"</span>, <span class="st">"a79"</span>, <span class="st">"a83"</span>, <span class="st">"a84"</span>, <span class="st">"a85"</span>, <span class="st">"a88"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">"a89"</span>, <span class="st">"a92"</span>, <span class="st">"a98"</span>, <span class="st">"a102"</span>, <span class="st">"a103"</span>, <span class="st">"a106"</span>, <span class="st">"a108"</span>, <span class="st">"a110"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">"a111"</span>, <span class="st">"a115"</span>, <span class="st">"room_type"</span>, <span class="st">"price"</span>, <span class="st">"number_of_reviews"</span>, <span class="st">"last_review"</span>, <span class="st">"reviews_per_month"</span>, <span class="st">"neighborhood"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">"lagPrice"</span>, <span class="st">"property_type"</span>, <span class="st">"host_response_time"</span>, <span class="st">"security_deposit"</span>, <span class="st">"cleaning_fee"</span>, <span class="st">"guests_included"</span>, <span class="st">"extra_people"</span>, <span class="st">"availability_30"</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">"availability_60"</span>, <span class="st">"availability_90"</span>, <span class="st">"instant_bookable"</span>, <span class="st">"cancellation_policy"</span>, <span class="st">"require_guest_profile_picture"</span>, <span class="st">"require_guest_phone_verification"</span>, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">"lagPE"</span>, <span class="st">"id"</span>, <span class="st">"lagAPE"</span>, <span class="st">"lagError"</span>, <span class="st">"lagAE"</span>, <span class="st">"beds"</span>, <span class="st">"a48"</span>, <span class="st">"a59"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">"sex_nn4"</span>, <span class="st">"sex_nn5"</span>, <span class="st">"pub_nn3"</span>, <span class="st">"pub_nn4"</span>, <span class="st">"protectdist"</span>, <span class="st">"host_has_profile_pic"</span>, <span class="st">"host_identity_verified"</span>, <span class="st">"instant_bookable"</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="st">"shopdist"</span>, <span class="st">"protectdist"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st">"development"</span>, <span class="st">"food_nn1"</span>, <span class="st">"food_nn2"</span>, <span class="st">"food_nn3"</span>, <span class="st">"food_nn4"</span>, <span class="st">"food_nn5"</span>, <span class="st">"shops_nn1"</span>, <span class="st">"shops_nn2"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">"shops_nn3"</span>, <span class="st">"shops_nn4"</span>, <span class="st">"shops_nn5"</span>, <span class="st">"playground_nn1"</span>, <span class="st">"playground_nn2"</span>, <span class="st">"playground_nn3"</span>, <span class="st">"playground_nn4"</span>, <span class="st">"playground_nn5"</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">"station_nn1"</span>, <span class="st">"station_nn2"</span>, <span class="st">"station_nn3"</span>, <span class="st">"station_nn4"</span>, <span class="st">"playfacilities_nn1"</span>, <span class="st">"playfacilities_nn2"</span>, <span class="st">"playfacilities_nn4"</span>, <span class="st">"playfacilities_nn5"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">"property_type"</span>, <span class="st">"review_scores_accuracy"</span>, <span class="st">"review_scores_communication"</span>, <span class="st">"review_scores_location"</span>, <span class="st">"a1"</span>, <span class="st">"a2"</span>, <span class="st">"a3"</span>, <span class="st">"a5"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">"a7"</span>, <span class="st">"a8"</span>, <span class="st">"a12"</span>, <span class="st">"a13"</span>, <span class="st">"a15"</span>, <span class="st">"a16"</span>, <span class="st">"a20"</span>, <span class="st">"a21"</span>, </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">"a23"</span>, <span class="st">"a27"</span>, <span class="st">"a28"</span>, <span class="st">"a31"</span>, <span class="st">"a33"</span>, <span class="st">"a35"</span>, <span class="st">"a38"</span>, <span class="st">"a39"</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">"a40"</span>, <span class="st">"a44"</span>, <span class="st">"a49"</span>, <span class="st">"a58"</span>, <span class="st">"a63"</span>, <span class="st">"a66"</span>, <span class="st">"a72"</span>, <span class="st">"a74"</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">"a75"</span>, <span class="st">"a80"</span>, <span class="st">"a81"</span>, <span class="st">"a82"</span>, <span class="st">"a86"</span>, <span class="st">"a90"</span>, <span class="st">"a91"</span>, <span class="st">"a93"</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">"a94"</span>, <span class="st">"a95"</span>, <span class="st">"a96"</span>, <span class="st">"a97"</span>, <span class="st">"a99"</span>, <span class="st">"a100"</span>, <span class="st">"a101"</span>, <span class="st">"a104"</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="st">"a107"</span>, <span class="st">"a108"</span>, <span class="st">"a109"</span>, <span class="st">"a110"</span>, <span class="st">"a113"</span>, <span class="st">"a114"</span>, <span class="st">"a116"</span>, <span class="st">"a118"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">"a119"</span>, <span class="st">"lagpredict"</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter4 <span class="op">=</span> Am_Basic_renter3[selected_columns]</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter5 <span class="op">=</span> pd.merge(Am_Time, Am_Basic_renter4, on<span class="op">=</span><span class="st">"id"</span>, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter5 <span class="op">=</span> Am_Basic_renter5.drop(columns<span class="op">=</span>[<span class="st">"available"</span>], errors<span class="op">=</span><span class="st">"ignore"</span>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter5 <span class="op">=</span> gpd.GeoDataFrame(Am_Basic_renter5).dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="1a8dce05-4112-4b89-bb24-6c0c515e7a1f" class="cell" data-results="hide" data-execution_count="63">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Am_Basic_renter5 <span class="op">=</span> Am_Basic_renter5.loc[:, <span class="op">~</span>Am_Basic_renter5.columns.duplicated()]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> Am_Basic_renter5.drop(columns<span class="op">=</span>[<span class="st">"price"</span>,<span class="st">'id'</span>])</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> Am_Basic_renter5[<span class="st">"price"</span>]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> X.select_dtypes(include<span class="op">=</span>[<span class="st">"object"</span>, <span class="st">"category"</span>]).columns</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"cat"</span>, OneHotEncoder(drop<span class="op">=</span><span class="st">"first"</span>), categorical_cols)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    remainder<span class="op">=</span><span class="st">"passthrough"</span>  </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> Pipeline(steps<span class="op">=</span>[(<span class="st">"preprocessor"</span>, preprocessor), (<span class="st">"regressor"</span>, LinearRegression())])</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>model1.fit(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="63">
<style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(remainder='passthrough',
                                   transformers=[('cat',
                                                  OneHotEncoder(drop='first'),
                                                  Index(['host_is_superhost', 'a6', 'a10', 'a11', 'a18', 'a19', 'a22', 'a24',
       'a26', 'a32',
       ...
       'a100', 'a101', 'a104', 'a107', 'a109', 'a113', 'a114', 'a116', 'a118',
       'a119'],
      dtype='object', length=113))])),
                ('regressor', LinearRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox"><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(remainder='passthrough',
                                   transformers=[('cat',
                                                  OneHotEncoder(drop='first'),
                                                  Index(['host_is_superhost', 'a6', 'a10', 'a11', 'a18', 'a19', 'a22', 'a24',
       'a26', 'a32',
       ...
       'a100', 'a101', 'a104', 'a107', 'a109', 'a113', 'a114', 'a116', 'a118',
       'a119'],
      dtype='object', length=113))])),
                ('regressor', LinearRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox"><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder='passthrough',
                  transformers=[('cat', OneHotEncoder(drop='first'),
                                 Index(['host_is_superhost', 'a6', 'a10', 'a11', 'a18', 'a19', 'a22', 'a24',
       'a26', 'a32',
       ...
       'a100', 'a101', 'a104', 'a107', 'a109', 'a113', 'a114', 'a116', 'a118',
       'a119'],
      dtype='object', length=113))])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox"><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>Index(['host_is_superhost', 'a6', 'a10', 'a11', 'a18', 'a19', 'a22', 'a24',
       'a26', 'a32',
       ...
       'a100', 'a101', 'a104', 'a107', 'a109', 'a113', 'a114', 'a116', 'a118',
       'a119'],
      dtype='object', length=113)</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox"><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(drop='first')</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox"><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre>['pricex', 'month', 'day', 'n', 'x', 'accommodates', 'bathrooms', 'bedrooms', 'first_review', 'review_scores_rating', 'review_scores_cleanliness', 'review_scores_checkin', 'review_scores_value', 'number_of_reviews', 'last_review', 'reviews_per_month', 'lagPrice', 'security_deposit', 'cleaning_fee', 'guests_included', 'extra_people', 'availability_30', 'availability_60', 'availability_90', 'lagPE', 'lagAPE', 'lagError', 'lagAE', 'beds', 'sex_nn4', 'sex_nn5', 'pub_nn3', 'pub_nn4', 'protectdist', 'shopdist', 'food_nn1', 'food_nn2', 'food_nn3', 'food_nn4', 'food_nn5', 'shops_nn1', 'shops_nn2', 'shops_nn3', 'shops_nn4', 'shops_nn5', 'playground_nn1', 'playground_nn2', 'playground_nn3', 'playground_nn4', 'playground_nn5', 'station_nn1', 'station_nn2', 'station_nn3', 'station_nn4', 'playfacilities_nn1', 'playfacilities_nn2', 'playfacilities_nn4', 'playfacilities_nn5', 'review_scores_accuracy', 'review_scores_communication', 'review_scores_location', 'lagpredict']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-13" type="checkbox"><label for="sk-estimator-id-13" class="sk-toggleable__label sk-toggleable__label-arrow">passthrough</label><div class="sk-toggleable__content"><pre>passthrough</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-14" type="checkbox"><label for="sk-estimator-id-14" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div>
</div>
</div>
</section>
<section id="real-time-price-model-summary" class="level4">
<h4 class="anchored" data-anchor-id="real-time-price-model-summary">4.1.2 Real-time Price Model Summary</h4>
<p>This model is highly accountable and accurate that undergone 2 training sets with average price and real-time price two dependent variables respectively. Through the training of two sets. I realize the prediction of the real-time price and avoid the co-linearity of the influence of price, and total order numbers and revenue, and other variables that costumers couldn’t choose.</p>
<div id="fc53a9c8-3b12-4161-b37c-d88b47c7f71e" class="cell" data-results="hide" data-execution_count="64">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Variable4 <span class="op">=</span> pd.read_excel(<span class="st">"New folder/New Microsoft Excel Worksheet (5).xlsx"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Variable4.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">Adjusted R2</th>
<th data-quarto-table-cell-role="th">Residual Standard Error</th>
<th data-quarto-table-cell-role="th">Median Residuals</th>
<th data-quarto-table-cell-role="th">Mean Absolute Percent Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Renter Price</td>
<td>0.8527</td>
<td>38.61</td>
<td>-2.81</td>
<td>0.17843</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>There are 171 variables that are significant for real-time price prediction. The data type and determine way of them are showed as below. They can be further classified as preset star-level options for easy usage of renters to find price references quickly. Hosts can adjust their advertising strategies according to the results.</p>
<div id="b7256089-ae43-48dc-a19c-c93d844bf4a0" class="cell" data-results="hide" data-execution_count="65">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Variable4 <span class="op">=</span> pd.read_excel(<span class="st">"New folder/New Microsoft Excel Worksheet (4).xlsx"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Variable4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Code Name</th>
<th data-quarto-table-cell-role="th">Features</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Data Type</th>
<th data-quarto-table-cell-role="th">Training Set</th>
<th data-quarto-table-cell-role="th">Determine Way</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>pricex</td>
<td>real-time price according to the day</td>
<td>Order Information</td>
<td>Numeric</td>
<td>the larger one</td>
<td>True Outcome</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>month</td>
<td>the month of the order</td>
<td>Order Information</td>
<td>Numeric</td>
<td>the larger one</td>
<td>Date</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>day</td>
<td>the day of the order</td>
<td>Order Information</td>
<td>Numeric</td>
<td>the larger one</td>
<td>Date</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>first_review</td>
<td>the date of the first review</td>
<td>Evaluations</td>
<td>Numeric</td>
<td>the smaller one</td>
<td>Review Reference</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>review_scores_rating</td>
<td>the total scores</td>
<td>Evaluations</td>
<td>Numeric</td>
<td>the smaller one</td>
<td>Review Reference</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">165</td>
<td>lagPE</td>
<td>lag of percent error defined by the weighted p...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>the one after preliminary model</td>
<td>Fixed</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">166</td>
<td>lagAPE</td>
<td>lag of absolute percent error defined by the w...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>the one after preliminary model</td>
<td>Fixed</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">167</td>
<td>lagError</td>
<td>lag of error defined by the weighted price of ...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>the one after preliminary model</td>
<td>Fixed</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">168</td>
<td>lagAE</td>
<td>lag of absolute error defined by the weighted ...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>the one after preliminary model</td>
<td>Fixed</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">169</td>
<td>lagpredict</td>
<td>lag of predicted value defined by the weighted...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>the one after preliminary model</td>
<td>Fixed</td>
</tr>
</tbody>
</table>

<p>170 rows × 6 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="for-hosts" class="level3">
<h3 class="anchored" data-anchor-id="for-hosts">4.2 For Hosts</h3>
<p>There is a model system for hosts that includes 10 models. one for potential average revenue prediction, one for potential average orders prediction, 8 for evaluation prediction (one for total rates prediction with all possible variables, one for total rates prediction with sub-evaluation rates, six for sub-evaluation rates such as communication, cleanness). Here price is a independent variable. Hosts can adjust their price, setting, performance strategies to improve their total rates, revenue, order numbers, sub-evaluation rates, or check out which sub-evaluation rates influence the total rates most and find a way to improve. They can do these adjustment with consideration of cost, expectation or the government policies.</p>
<section id="modeling-1" class="level4">
<h4 class="anchored" data-anchor-id="modeling-1">4.2.1 Modeling</h4>
<div id="2309fad9-35a2-480a-8623-755fc7a999fd" class="cell" data-results="hide" data-execution_count="66">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#all rate</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder <span class="op">=</span> Am_Basic5.merge(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    Am_Time[[<span class="st">'id'</span>, <span class="st">'n'</span>, <span class="st">'x'</span>]].drop_duplicates(), on<span class="op">=</span><span class="st">"id"</span>, how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>).drop_duplicates()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder <span class="op">=</span> Am_Basic_Holder.merge(diffdate, on<span class="op">=</span><span class="st">"id"</span>, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder[<span class="st">'average_n'</span>] <span class="op">=</span> Am_Basic_Holder[<span class="st">'n'</span>] <span class="op">/</span> Am_Basic_Holder[<span class="st">'diffday'</span>]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder[<span class="st">'average_x'</span>] <span class="op">=</span> Am_Basic_Holder[<span class="st">'x'</span>] <span class="op">/</span> Am_Basic_Holder[<span class="st">'diffday'</span>]</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate1 <span class="op">=</span> Am_Basic_Holder[[</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="st">'host_since'</span>, <span class="st">'host_response_time'</span>, <span class="st">'host_response_rate'</span>, <span class="st">'host_is_superhost'</span>, </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="st">'host_listings_count'</span>, <span class="st">'host_has_profile_pic'</span>, <span class="st">'host_identity_verified'</span>, </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="st">'is_location_exact'</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="st">'property_type'</span>, <span class="st">'accommodates'</span>, <span class="st">'bathrooms'</span>, <span class="st">'bedrooms'</span>, <span class="st">'beds'</span>, <span class="st">'bed_type'</span>, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="st">'security_deposit'</span>, <span class="st">'cleaning_fee'</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="st">'guests_included'</span>, <span class="st">'extra_people'</span>, <span class="st">'maximum_nights'</span>, <span class="st">'has_availability'</span>, </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="st">'availability_30'</span>, <span class="st">'availability_60'</span>, <span class="st">'availability_90'</span>, <span class="st">'first_review'</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="st">'instant_bookable'</span>, <span class="st">'cancellation_policy'</span>, <span class="st">'require_guest_profile_picture'</span>, </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="st">'require_guest_phone_verification'</span>, <span class="st">'a1'</span>, <span class="st">'a2'</span>, <span class="st">'a3'</span>, <span class="st">'a4'</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="st">'a5'</span>, <span class="st">'a6'</span>, <span class="st">'a7'</span>, <span class="st">'a8'</span>, <span class="st">'a9'</span>, <span class="st">'a10'</span>, <span class="st">'a11'</span>, <span class="st">'a12'</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="st">'a13'</span>, <span class="st">'a14'</span>, <span class="st">'a15'</span>, <span class="st">'a16'</span>, <span class="st">'a17'</span>, <span class="st">'a18'</span>, <span class="st">'a19'</span>, <span class="st">'a20'</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="st">'a21'</span>, <span class="st">'a22'</span>, <span class="st">'a23'</span>, <span class="st">'a24'</span>, <span class="st">'a25'</span>, <span class="st">'a26'</span>, <span class="st">'a27'</span>, <span class="st">'a28'</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="st">'a29'</span>, <span class="st">'a30'</span>, <span class="st">'a31'</span>, <span class="st">'a32'</span>, <span class="st">'a33'</span>, <span class="st">'a34'</span>, <span class="st">'a35'</span>, <span class="st">'a36'</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="st">'a37'</span>, <span class="st">'a38'</span>, <span class="st">'a39'</span>, <span class="st">'a40'</span>, <span class="st">'a41'</span>, <span class="st">'a42'</span>, <span class="st">'a43'</span>, <span class="st">'a44'</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="st">'a45'</span>, <span class="st">'a46'</span>, <span class="st">'a47'</span>, <span class="st">'a48'</span>, <span class="st">'a49'</span>, <span class="st">'a50'</span>, <span class="st">'a51'</span>, <span class="st">'a52'</span>,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="st">'a53'</span>, <span class="st">'a54'</span>, <span class="st">'a55'</span>, <span class="st">'a56'</span>, <span class="st">'a57'</span>, <span class="st">'a58'</span>, <span class="st">'a59'</span>, <span class="st">'a60'</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="st">'a61'</span>, <span class="st">'a62'</span>, <span class="st">'a63'</span>, <span class="st">'a64'</span>, <span class="st">'a65'</span>, <span class="st">'a66'</span>, <span class="st">'a67'</span>, <span class="st">'a68'</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="st">'a69'</span>, <span class="st">'a70'</span>, <span class="st">'a71'</span>, <span class="st">'a72'</span>, <span class="st">'a73'</span>, <span class="st">'a74'</span>, <span class="st">'a75'</span>, <span class="st">'a76'</span>,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="st">'a78'</span>, <span class="st">'a79'</span>, <span class="st">'a80'</span>, <span class="st">'a81'</span>, <span class="st">'a82'</span>, <span class="st">'a83'</span>, <span class="st">'a84'</span>, <span class="st">'a85'</span>,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="st">'a86'</span>, <span class="st">'a87'</span>, <span class="st">'a88'</span>, <span class="st">'a89'</span>, <span class="st">'a90'</span>, <span class="st">'a91'</span>, <span class="st">'a92'</span>, <span class="st">'a93'</span>,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="st">'a94'</span>, <span class="st">'a95'</span>, <span class="st">'a96'</span>, <span class="st">'a97'</span>, <span class="st">'a98'</span>, <span class="st">'a99'</span>, <span class="st">'a100'</span>, <span class="st">'a101'</span>,</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="st">'a102'</span>, <span class="st">'a103'</span>, <span class="st">'a104'</span>, <span class="st">'a105'</span>, <span class="st">'a106'</span>, <span class="st">'a107'</span>, <span class="st">'a108'</span>, </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="st">'a109'</span>,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="st">'a110'</span>, <span class="st">'a111'</span>, <span class="st">'a112'</span>, <span class="st">'a113'</span>, <span class="st">'a114'</span>, <span class="st">'a115'</span>, <span class="st">'a116'</span>, </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="st">'a117'</span>,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="st">'a118'</span>, <span class="st">'a119'</span>, <span class="st">'a120'</span>, <span class="st">'room_type'</span>, <span class="st">'price'</span>, <span class="st">'minimum_nights'</span>, </span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="st">'number_of_reviews'</span>, <span class="st">'last_review'</span>,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="st">'reviews_per_month'</span>, <span class="st">'calculated_host_listings_count'</span>, <span class="st">'neighborhood'</span>, </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="st">'shops_nn1'</span>, <span class="st">'shops_nn2'</span>, <span class="st">'shops_nn3'</span>, <span class="st">'shops_nn4'</span>, <span class="st">'shops_nn5'</span>,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="st">'playground_nn1'</span>, <span class="st">'playground_nn2'</span>, <span class="st">'playground_nn3'</span>, <span class="st">'playground_nn4'</span>, </span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="st">'playground_nn5'</span>, <span class="st">'station_nn1'</span>, <span class="st">'station_nn2'</span>, <span class="st">'station_nn3'</span>,</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="st">'station_nn4'</span>, <span class="st">'station_nn5'</span>, <span class="st">'playfacilities_nn1'</span>, <span class="st">'playfacilities_nn2'</span>, </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="st">'playfacilities_nn3'</span>, <span class="st">'playfacilities_nn4'</span>, <span class="st">'playfacilities_nn5'</span>, </span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="st">'sightseeing_nn1'</span>,</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="st">'sightseeing_nn2'</span>, <span class="st">'sightseeing_nn3'</span>, <span class="st">'sightseeing_nn4'</span>, <span class="st">'sightseeing_nn5'</span>, </span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="st">'food_nn1'</span>, <span class="st">'food_nn2'</span>, <span class="st">'food_nn3'</span>, <span class="st">'food_nn4'</span>,</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="st">'food_nn5'</span>, <span class="st">'sex_nn1'</span>, <span class="st">'sex_nn2'</span>, <span class="st">'sex_nn3'</span>, <span class="st">'sex_nn4'</span>, <span class="st">'sex_nn5'</span>, <span class="st">'pub_nn1'</span>, </span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="st">'pub_nn2'</span>,</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="st">'pub_nn3'</span>, <span class="st">'pub_nn4'</span>, <span class="st">'pub_nn5'</span>, <span class="st">'walk'</span>, <span class="st">'shopdist'</span>, <span class="st">'protectdist'</span>, </span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="st">'poordist'</span>, <span class="st">'shopping'</span>,</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="st">'protect'</span>, <span class="st">'development'</span>, <span class="st">'n'</span>, <span class="st">'x'</span>, <span class="st">'diffday'</span>, <span class="st">'average_n'</span>, <span class="st">'average_x'</span>, </span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="st">'review_scores_rating'</span>,</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="st">'review_scores_accuracy'</span>, <span class="st">'review_scores_cleanliness'</span>, </span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="st">'review_scores_checkin'</span>, <span class="st">'review_scores_communication'</span>, </span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="st">'review_scores_location'</span>, <span class="st">'review_scores_value'</span>, </span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="st">'geometry'</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>]]</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate <span class="op">=</span> (</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    Am_Basic_Holder_TZRate1[</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">'host_since'</span>, <span class="st">'host_response_time'</span>, <span class="st">'host_response_rate'</span>, <span class="st">'host_is_superhost'</span>, </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">'host_has_profile_pic'</span>, <span class="st">'is_location_exact'</span>, <span class="st">'property_type'</span>, <span class="st">'bedrooms'</span>, <span class="st">'beds'</span>, </span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>            <span class="st">'maximum_nights'</span>, <span class="st">'first_review'</span>, <span class="st">'a6'</span>, <span class="st">'a15'</span>, <span class="st">'a21'</span>, <span class="st">'a35'</span>, <span class="st">'a38'</span>, <span class="st">'a48'</span>, <span class="st">'a49'</span>, </span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>            <span class="st">'a52'</span>, <span class="st">'a54'</span>, <span class="st">'a75'</span>, <span class="st">'a78'</span>, <span class="st">'a82'</span>, <span class="st">'a104'</span>, <span class="st">'room_type'</span>, <span class="st">'price'</span>, <span class="st">'last_review'</span>, </span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>            <span class="st">'reviews_per_month'</span>, <span class="st">'neighborhood'</span>, <span class="st">'shops_nn5'</span>, <span class="st">'playfacilities_nn1'</span>, </span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">'poordist'</span>, <span class="st">'development'</span>, <span class="st">'review_scores_rating'</span>, <span class="st">'review_scores_accuracy'</span>, </span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>            <span class="st">'review_scores_cleanliness'</span>, <span class="st">'review_scores_checkin'</span>, <span class="st">'review_scores_communication'</span>, </span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">'review_scores_location'</span>, <span class="st">'review_scores_value'</span>, <span class="st">'geometry'</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>    ].dropna()</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>coordsTZ <span class="op">=</span> np.array(<span class="bu">list</span>(Am_Basic_Holder_TZRate.geometry.<span class="bu">apply</span>(<span class="kw">lambda</span> geom: (geom.x, geom.y))))</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>neighborList_TZ <span class="op">=</span> KNN.from_array(coordsTZ, k<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>spatialWeights_TZ <span class="op">=</span> neighborList_TZ</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'lagT'</span>] <span class="op">=</span> lag_spatial(spatialWeights_TZ, Am_Basic_Holder_TZRate[<span class="st">'review_scores_rating'</span>].values)</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> Am_Basic_Holder_TZRate.drop(columns<span class="op">=</span>[<span class="st">'geometry'</span>]).dropna()</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>numerical_features <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>]).columns <span class="cf">if</span> col <span class="op">!=</span> <span class="st">'review_scores_rating'</span>]</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>categorical_features <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>, <span class="st">'category'</span>]).columns]</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'num'</span>, <span class="st">'passthrough'</span>, numerical_features),</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'cat'</span>, OneHotEncoder(drop<span class="op">=</span><span class="st">'first'</span>), categorical_features)</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Pipeline(steps<span class="op">=</span>[(<span class="st">'preprocessor'</span>, preprocessor), (<span class="st">'regressor'</span>, LinearRegression())])</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(columns<span class="op">=</span>[<span class="st">'review_scores_rating'</span>])</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">'review_scores_rating'</span>]</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>Holder_TZ <span class="op">=</span> model.fit(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="7b8536d2-7315-4361-9dc6-32d53a3e88fd" class="cell" data-results="hide" data-execution_count="67">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate <span class="op">=</span> Am_Basic_Holder_TZRate.dropna()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'T_Predict'</span>] <span class="op">=</span> model.predict(Am_Basic_Holder_TZRate.drop(columns<span class="op">=</span>[<span class="st">'review_scores_rating'</span>, <span class="st">'geometry'</span>], errors<span class="op">=</span><span class="st">'ignore'</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'T_Error'</span>] <span class="op">=</span> Am_Basic_Holder_TZRate[<span class="st">'T_Predict'</span>] <span class="op">-</span> Am_Basic_Holder_TZRate[<span class="st">'review_scores_rating'</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'T_AE'</span>] <span class="op">=</span> Am_Basic_Holder_TZRate[<span class="st">'T_Error'</span>].<span class="bu">abs</span>()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'T_APE'</span>] <span class="op">=</span> Am_Basic_Holder_TZRate[<span class="st">'T_AE'</span>] <span class="op">/</span> Am_Basic_Holder_TZRate[<span class="st">'T_Predict'</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'T_PE'</span>] <span class="op">=</span> Am_Basic_Holder_TZRate[<span class="st">'T_Error'</span>] <span class="op">/</span> Am_Basic_Holder_TZRate[<span class="st">'T_Predict'</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>neighborList_T_E <span class="op">=</span> KNN.from_array(coordsTZ, k<span class="op">=</span><span class="dv">170</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>spatialWeights_T_E <span class="op">=</span> neighborList_T_E</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="59987882-a048-4bea-af0d-64e174ac3ae9" class="cell" data-results="hide" data-execution_count="68">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'lagError'</span>] <span class="op">=</span> lag_spatial(spatialWeights_T_E, Am_Basic_Holder_TZRate[<span class="st">'T_Error'</span>].values)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'lagAE'</span>] <span class="op">=</span> lag_spatial(spatialWeights_T_E, Am_Basic_Holder_TZRate[<span class="st">'T_AE'</span>].values)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'lagAPE'</span>] <span class="op">=</span> lag_spatial(spatialWeights_T_E, Am_Basic_Holder_TZRate[<span class="st">'T_APE'</span>].values)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'lagPE'</span>] <span class="op">=</span> lag_spatial(spatialWeights_T_E, Am_Basic_Holder_TZRate[<span class="st">'T_PE'</span>].values)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Am_Basic_Holder_TZRate[<span class="st">'lagPredict'</span>] <span class="op">=</span> lag_spatial(spatialWeights_T_E, Am_Basic_Holder_TZRate[<span class="st">'T_Predict'</span>].values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e9de84c4-9c11-48e9-b887-e98c55bac45c" class="cell" data-results="hide" data-execution_count="69">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> Am_Basic_Holder_TZRate.drop(columns<span class="op">=</span>[<span class="st">'geometry'</span>]).dropna()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>numerical_features <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>]).columns <span class="cf">if</span> col <span class="op">!=</span> <span class="st">'review_scores_rating'</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>categorical_features <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>, <span class="st">'category'</span>]).columns]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'num'</span>, <span class="st">'passthrough'</span>, numerical_features),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'cat'</span>, OneHotEncoder(drop<span class="op">=</span><span class="st">'first'</span>), categorical_features)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Pipeline(steps<span class="op">=</span>[(<span class="st">'preprocessor'</span>, preprocessor), (<span class="st">'regressor'</span>, LinearRegression())])</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(columns<span class="op">=</span>[<span class="st">'review_scores_rating'</span>])</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">'review_scores_rating'</span>]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>Holder_TZ <span class="op">=</span> model.fit(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="hosts-model-summary" class="level4">
<h4 class="anchored" data-anchor-id="hosts-model-summary">4.2.2 Hosts Model Summary</h4>
<p>I also did 9 more models for other score/rating aspects, for more detailed strategies. These models are all accurate and generalizable, especially for the total revenue, orders, and rates prediction with all possible variables. Here are the detailed information of each model and their usage. This system ensures the host to make response to market and government situations quickly and effectively.</p>
<div id="e1984fb4-bdbc-41f2-84cf-846637eca0e5" class="cell" data-results="hide" data-execution_count="70">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Variable6 <span class="op">=</span> pd.read_excel(<span class="st">"New folder/New Microsoft Excel Worksheet (6).xlsx"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Variable6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">Adjusted R2</th>
<th data-quarto-table-cell-role="th">Residual Standard Error</th>
<th data-quarto-table-cell-role="th">Median Residuals</th>
<th data-quarto-table-cell-role="th">Mean Absolute Percent Error</th>
<th data-quarto-table-cell-role="th">Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Host Total Rates All</td>
<td>0.7240</td>
<td>3.4900</td>
<td>0.16900</td>
<td>0.0257</td>
<td>to adjust all possible features for expected t...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Host Total Rates Sub</td>
<td>0.7157</td>
<td>3.5430</td>
<td>0.23000</td>
<td>0.0261</td>
<td>to adjust sub-evaluations for expected total r...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Host Accuracy Rates</td>
<td>0.7234</td>
<td>0.5718</td>
<td>0.11550</td>
<td>0.0430</td>
<td>to adjust all possible features for expected a...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Host Cleanliness Rates</td>
<td>0.6980</td>
<td>0.4563</td>
<td>0.09680</td>
<td>0.0230</td>
<td>to adjust all possible features for expected c...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Host Checkin Rates</td>
<td>0.7210</td>
<td>0.3560</td>
<td>0.04560</td>
<td>0.0342</td>
<td>to adjust all possible features for expected c...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Host Communication Rates</td>
<td>0.7110</td>
<td>0.7630</td>
<td>0.08780</td>
<td>0.0412</td>
<td>to adjust all possible features for expected c...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Host Location Rates</td>
<td>0.6980</td>
<td>0.5240</td>
<td>0.06810</td>
<td>0.0242</td>
<td>to adjust all possible features for expected l...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Host Value Rates</td>
<td>0.7070</td>
<td>0.5450</td>
<td>0.12110</td>
<td>0.0463</td>
<td>to adjust all possible features for expected v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Host Average Orders</td>
<td>0.7320</td>
<td>0.1148</td>
<td>0.00125</td>
<td>0.2110</td>
<td>to adjust all possible features for expected a...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Host Average Revenue</td>
<td>0.7320</td>
<td>43.3900</td>
<td>-2.83000</td>
<td>0.2750</td>
<td>to adjust all possible features for expected a...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>All related important variables are reclassified by their models.</p>
<div id="fa4c658b-135b-4ff4-bdfb-72323bd1c679" class="cell" data-results="hide" data-execution_count="71">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Variable7 <span class="op">=</span> pd.read_excel(<span class="st">"New folder/New Microsoft Excel Worksheet (7).xlsx"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Variable7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Code Name</th>
<th data-quarto-table-cell-role="th">Features</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Data Type</th>
<th data-quarto-table-cell-role="th">Determine Way</th>
<th data-quarto-table-cell-role="th">For Which Model</th>
<th data-quarto-table-cell-role="th">Freedom of This Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>review_scores_rating</td>
<td>the total scores</td>
<td>Evaluations</td>
<td>Numeric</td>
<td>Outcome</td>
<td>Host Total Rates All</td>
<td>36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>price</td>
<td>average price</td>
<td>Housing Information</td>
<td>Numeric</td>
<td>Input</td>
<td>Host Total Rates All</td>
<td>36</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>review_scores_accuracy</td>
<td>the socres of information accuracy</td>
<td>Evaluations</td>
<td>Numeric</td>
<td>Input</td>
<td>Host Total Rates All</td>
<td>36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>review_scores_cleanliness</td>
<td>the socres of cleanliness</td>
<td>Evaluations</td>
<td>Numeric</td>
<td>Input</td>
<td>Host Total Rates All</td>
<td>36</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>review_scores_checkin</td>
<td>the socres for check in process</td>
<td>Evaluations</td>
<td>Numeric</td>
<td>Input</td>
<td>Host Total Rates All</td>
<td>36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">470</td>
<td>lagrevenue</td>
<td>lag of revenue defined by the weighted price o...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>Fixed</td>
<td>Host Average Revenue</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">471</td>
<td>lagError</td>
<td>lag of error defined by the weighted price of ...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>Fixed</td>
<td>Host Average Revenue</td>
<td>44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">472</td>
<td>lagAE</td>
<td>lag of absolute error defined by the weighted ...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>Fixed</td>
<td>Host Average Revenue</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">473</td>
<td>lagAPE</td>
<td>lag of absolute percent error defined by the w...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>Fixed</td>
<td>Host Average Revenue</td>
<td>44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">474</td>
<td>lagPE</td>
<td>lag of percent error defined by the weighted p...</td>
<td>Spatial Structrue</td>
<td>Numeric</td>
<td>Fixed</td>
<td>Host Average Revenue</td>
<td>44</td>
</tr>
</tbody>
</table>

<p>475 rows × 7 columns</p>
</div>
</div>
</div>
<p>Some variables are important for all host models. By sorting the variable by frequency below, we can see the common important variables are:</p>
<ul>
<li><p>host performance (calculated host listing count, response time, host response rate, whether the host is a superhost, the time hosted from, whether the housing’s location is exact, whether the host’s identity is verified)</p></li>
<li><p>housing rules (whether it is instant bookable, cleaning fee, the cancellation policy, the maximum continuous nights you can book, long term stays allowed, smoking allowed, whether it is available in 30 days, 24-hour check-in, the maximum number of extra people in it, the maximum number of guests in it)</p></li>
<li><p>amenities (Lock on bedroom door, smoke detector, host greets you, iron, washer, room type, property type, suitable for events, baby bath, bed linens, carbon monoxide detector, dryer, gym, kitchen, TV)</p></li>
<li><p>location (in which neighborhood, the distance to the nearest 3-5 sex points, the distance to the nearest playfacility)</p></li>
<li><p>reviews (reviews per month, the date of the first review, the date of the last review, the scores for value, the scores of cleanliness, number of reviews)</p></li>
<li><p>operation situation (average price, average daily order number)</p></li>
</ul>
<p>These variables prove people are more concern with <strong>safety, basic needs, the number of people the housing allowed, host performance, and host experience, whether in a good neighborhood, short-term availability, and accessibility to special experience places such as red zones and playficilities</strong>. For different outcome, people also put different extent of attention to different variables. These variables’ positive and negative influence can be checked through the analysis of the “estimates” of each variable of each model. It can better serve hosts to come up with strategies.</p>
<p>It also shows that people are not so demanding on the housing. Just by improving basic, proper but necessary service with flexible housing rules, controlling short-term availability properly, caring children, family, and minorities’ special needs, and excavating surrounding interesting points, they can improve their evaluations and average orders and revenue along with time, and the increase of order, and make renters feel worthy to live here.</p>
<p>These variables doesn’t relate to the outcome directly, but they can effect costumers’ cognition. It also shows that the accumulated orders and order frequency, and operation time can also improve the outcome. They can promote orders with some methods without decreasing service and quality, they can improve their housing overall performance along with time.</p>
<p>These models are not fixed with certain variables. As we imagined, <strong>the real-time data of the market of the latest time-period will continuously be put into the training of the model</strong>. Some variables could be added into consideration, and some of them could be not any more.</p>
</section>
</section>
<section id="performance" class="level3">
<h3 class="anchored" data-anchor-id="performance">4.3 Performance</h3>
<p>These variables are highly refined. Their correlation of the price of the house are as below. The first plot contains too many variables. Here it only serves to show the correlation relationship roughly.</p>
<div id="e43fbe9a-0e6f-4e88-a7c0-674a1904ba0d" class="cell" data-results="hide" data-execution_count="72">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>numericVars_ns <span class="op">=</span> Am_Basic_Holder_TZRate.drop(columns<span class="op">=</span>[<span class="st">'T_Predict'</span>, <span class="st">'T_Error'</span>, <span class="st">'T_AE'</span>, <span class="st">'T_APE'</span>, <span class="st">'T_PE'</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>numericVars_ns <span class="op">=</span> numericVars_ns.select_dtypes(include<span class="op">=</span>[np.number])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> numericVars_ns.corr()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr_matrix, dtype<span class="op">=</span><span class="bu">bool</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.heatmap(corr_matrix, mask<span class="op">=</span>mask, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">".2f"</span>, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, cbar<span class="op">=</span><span class="va">True</span>, annot_kws<span class="op">=</span>{<span class="st">"size"</span>:<span class="dv">6</span>})</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Correlation across numeric variables Selected"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">""</span>, fontsize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">""</span>, fontsize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.05</span>, <span class="st">""</span>, ha<span class="op">=</span><span class="st">"center"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-44-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Below plots show the relationship between 4 important continuous features and the outcome. As one of the most internal attributes, the number of days from the start of hosting has positive influence on the total rates. Price significantly influences people’s expectation and the final rates. It shows that the higher the price the higher the scores. It means that the housing units with higher price tend to have better experience for renters in Amsterdam. Lag Error is a feature that is not controllable for hosts, but can help the self-correction of the model. The distance to the nearest 5 shops have a negative estimate. It means that people like to live near many shops. It will increase the rate of the housing. Among all the sub-evaluations, the accuracy and value rate has the highest positive estimates. It means that people will rate the housing that will full fill what it advertises and make people feel worthy high. Hosts should realize what they advertise.</p>
<div id="c02f792b-378f-4ff9-922c-26d9edc581f1" class="cell" data-tags="[]" data-results="hide" data-execution_count="73">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> Am_Basic_Holder_TZRate[[<span class="st">'review_scores_rating'</span>, <span class="st">'shops_nn5'</span>]]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>, context<span class="op">=</span><span class="st">"talk"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> sns.scatterplot(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>data, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'shops_nn5'</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'review_scores_rating'</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'shops_nn5'</span>, </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'shops_nn5'</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">'RdPu'</span>, </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>slope, intercept, r_value, p_value, std_err <span class="op">=</span> linregress(data[<span class="st">'shops_nn5'</span>], data[<span class="st">'review_scores_rating'</span>])</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>x_vals <span class="op">=</span> np.linspace(data[<span class="st">'shops_nn5'</span>].<span class="bu">min</span>(), data[<span class="st">'shops_nn5'</span>].<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>y_vals <span class="op">=</span> intercept <span class="op">+</span> slope <span class="op">*</span> x_vals</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>plt.plot(x_vals, y_vals, color<span class="op">=</span><span class="st">"#FA7878"</span>, linestyle<span class="op">=</span><span class="st">"-"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Linear Fit"</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>mean_value <span class="op">=</span> data[<span class="st">'shops_nn5'</span>].mean()</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>mean_value, color<span class="op">=</span><span class="st">"#FA7800"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="ss">f"Mean: </span><span class="sc">{</span>mean_value<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Total Rates as the function of the distance to the nearest 5 shops"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"The distance to the nearest 5 shops"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Total review rates"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.9</span>, <span class="fl">0.01</span>, <span class="st">""</span>, horizontalalignment<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)        </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Legend"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-45-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="41599735-4d8d-47d6-a21a-7fef25a33d9a" class="cell" data-results="hide" data-execution_count="74">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> Am_Basic_Holder_TZRate[[<span class="st">'review_scores_rating'</span>, <span class="st">'lagError'</span>]]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>, context<span class="op">=</span><span class="st">"talk"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> sns.scatterplot(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>data, </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'lagError'</span>, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'review_scores_rating'</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'lagError'</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'lagError'</span>, </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">'RdPu'</span>, </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>slope, intercept, r_value, p_value, std_err <span class="op">=</span> linregress(data[<span class="st">'lagError'</span>], data[<span class="st">'review_scores_rating'</span>])</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>x_vals <span class="op">=</span> np.linspace(data[<span class="st">'lagError'</span>].<span class="bu">min</span>(), data[<span class="st">'lagError'</span>].<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>y_vals <span class="op">=</span> intercept <span class="op">+</span> slope <span class="op">*</span> x_vals</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>plt.plot(x_vals, y_vals, color<span class="op">=</span><span class="st">"#FA7878"</span>, linestyle<span class="op">=</span><span class="st">"-"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Linear Fit"</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>mean_value <span class="op">=</span> data[<span class="st">'lagError'</span>].mean()</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>mean_value, color<span class="op">=</span><span class="st">"#FA7800"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="ss">f"Mean: </span><span class="sc">{</span>mean_value<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Total Rates as the function of the lag error"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"lag error defined by several nearest points"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Total review rates"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.9</span>, <span class="fl">0.01</span>, <span class="st">""</span>, horizontalalignment<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)        </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Legend"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="da042774-9d0b-4155-9fd0-54409265e092" class="cell" data-results="hide" data-execution_count="75">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> Am_Basic_Holder_TZRate[[<span class="st">'review_scores_rating'</span>, <span class="st">'host_since'</span>]]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>, context<span class="op">=</span><span class="st">"talk"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> sns.scatterplot(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>data, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'host_since'</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'review_scores_rating'</span>, </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'host_since'</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'host_since'</span>, </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">'RdPu'</span>, </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>slope, intercept, r_value, p_value, std_err <span class="op">=</span> linregress(data[<span class="st">'host_since'</span>], data[<span class="st">'review_scores_rating'</span>])</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>x_vals <span class="op">=</span> np.linspace(data[<span class="st">'host_since'</span>].<span class="bu">min</span>(), data[<span class="st">'host_since'</span>].<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>y_vals <span class="op">=</span> intercept <span class="op">+</span> slope <span class="op">*</span> x_vals</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>plt.plot(x_vals, y_vals, color<span class="op">=</span><span class="st">"#FA7878"</span>, linestyle<span class="op">=</span><span class="st">"-"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Linear Fit"</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>mean_value <span class="op">=</span> data[<span class="st">'host_since'</span>].mean()</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>mean_value, color<span class="op">=</span><span class="st">"#FA7800"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="ss">f"Mean: </span><span class="sc">{</span>mean_value<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Total Rates as the function of the Number of Days from the Start of Hosting"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"the number of days from the start of hosting"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Total review rates"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.9</span>, <span class="fl">0.01</span>, <span class="st">""</span>, horizontalalignment<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)        </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Legend"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-47-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="c6ed5fef-8a3a-40ad-a1bb-08aee5be00ec" class="cell" data-results="hide" data-execution_count="76">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> Am_Basic_Holder_TZRate[[<span class="st">'review_scores_rating'</span>, <span class="st">'price'</span>]]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>, context<span class="op">=</span><span class="st">"talk"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> sns.scatterplot(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>data, </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'price'</span>, </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'review_scores_rating'</span>, </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'price'</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'price'</span>, </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">'RdPu'</span>, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>slope, intercept, r_value, p_value, std_err <span class="op">=</span> linregress(data[<span class="st">'price'</span>], data[<span class="st">'review_scores_rating'</span>])</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>x_vals <span class="op">=</span> np.linspace(data[<span class="st">'price'</span>].<span class="bu">min</span>(), data[<span class="st">'price'</span>].<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>y_vals <span class="op">=</span> intercept <span class="op">+</span> slope <span class="op">*</span> x_vals</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>plt.plot(x_vals, y_vals, color<span class="op">=</span><span class="st">"#FA7878"</span>, linestyle<span class="op">=</span><span class="st">"-"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Linear Fit"</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>mean_value <span class="op">=</span> data[<span class="st">'price'</span>].mean()</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>mean_value, color<span class="op">=</span><span class="st">"#FA7800"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="ss">f"Mean: </span><span class="sc">{</span>mean_value<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Total Rates as the function of the price of the housing"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"average price of the housing"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Total review rates"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.9</span>, <span class="fl">0.01</span>, <span class="st">""</span>, horizontalalignment<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)        </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Legend"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The categorical variables (include Boolean variables) show an apparent correlation and significance. Among them, the host performance such as the response time and whether is a superhost, internal amenities such as TV and window guards, and distance to external facilities or areas such as sex places and development promoting area significantly influence the total rates. Host should have TV and window guards in the housing, should not buy property in a development area. Being a superhost has a relationship with the high rates, and it is significant. The title is worth to obtain. If they want to get more scores, they can buy properties surrounded by as many sex places but not too much. People who want to live in Airbnb like it averagely, and will rate the house with high scores. A middle response time corresponds to a higher rate, so the host can keep this time interval and save energy on other improvement.</p>
<div id="6f38e707-702a-4831-a56a-fefa8c40f8c5" class="cell" data-results="hide" data-execution_count="77">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Am_Basic_no_geo <span class="op">=</span> Am_Basic_Holder_TZRate.drop(columns<span class="op">=</span>[<span class="st">'geometry'</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>selected_data <span class="op">=</span> Am_Basic_no_geo[[<span class="st">'review_scores_rating'</span>, <span class="st">'host_response_time'</span>, <span class="st">'host_is_superhost'</span>, <span class="st">'a48'</span>, <span class="st">'a82'</span>, <span class="st">'development'</span>]]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>melted_data <span class="op">=</span> selected_data.melt(id_vars<span class="op">=</span>[<span class="st">'review_scores_rating'</span>], </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                                 var_name<span class="op">=</span><span class="st">'Variable'</span>, </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                                 value_name<span class="op">=</span><span class="st">'Value'</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>mean_data <span class="op">=</span> melted_data.groupby([<span class="st">'Variable'</span>, <span class="st">'Value'</span>])[<span class="st">'review_scores_rating'</span>].mean().reset_index()</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.FacetGrid(mean_data, col<span class="op">=</span><span class="st">"Variable"</span>, col_wrap<span class="op">=</span><span class="dv">3</span>, sharex<span class="op">=</span><span class="va">False</span>, sharey<span class="op">=</span><span class="va">False</span>, height<span class="op">=</span><span class="dv">5</span>, aspect<span class="op">=</span><span class="fl">1.2</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>g.map_dataframe(sns.barplot, x<span class="op">=</span><span class="st">"Value"</span>, y<span class="op">=</span><span class="st">"review_scores_rating"</span>, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span><span class="st">"white"</span>, edgecolor<span class="op">=</span><span class="st">"#aa003A"</span>, alpha<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>g.set_titles(col_template<span class="op">=</span><span class="st">"</span><span class="sc">{col_name}</span><span class="st">"</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>g.set_axis_labels(<span class="st">""</span>, <span class="st">"Total Price"</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>g.set_xticklabels(rotation<span class="op">=</span><span class="dv">45</span>, horizontalalignment<span class="op">=</span><span class="st">'right'</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>g.set_titles(fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>g.fig.suptitle(<span class="st">"Total Rates as a Function of Some Categorical Variables"</span>, fontsize<span class="op">=</span><span class="dv">20</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>g.fig.subplots_adjust(top<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="op">=</span> {</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"host_response_time"</span>: <span class="st">"Host Response Time"</span>,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"host_is_superhost"</span>: <span class="st">"Whether the Host is a Superhost"</span>,</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"a48"</span>: <span class="st">"TV"</span>,</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"a82"</span>: <span class="st">"Window Guards"</span>,</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"development"</span>: <span class="st">"Whether in a Development Area"</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, label <span class="kw">in</span> <span class="bu">zip</span>(g.axes.flat, g.col_names):</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    ax.set_title(custom_labels.get(label, label), fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.02</span>, <span class="st">"Figure 18"</span>, wrap<span class="op">=</span><span class="va">True</span>, horizontalalignment<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1400x1000 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-49-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>For the final host rating model, the actual total rates distribution is near random. But in the center of the city, the scores are relatively lower</p>
<div id="119fb983-2406-4b6f-b01c-010f9d311bce" class="cell" data-execution_count="78">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>display(Image(filename<span class="op">=</span><span class="st">"New folder/26.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-50-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The prediction map of the model is similar to the observed one that is randomly distributed with relatively lower rates in the city center. The model is valid.</p>
<p>It is interesting that the city center’s housing’s rates are lower. This area is just the area with the highest density of Airbnb units. Quantity doesn’t ensure the quality, not to say good reputation. It proves the rationality of the government’s policies that they must eliminate surplus low-quality Airbnb housing units in certain areas to realize high-quality and sustainable development.</p>
<div id="b4bafe72-29e9-41d7-9b1c-66b5efdd2dbd" class="cell" data-execution_count="79">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>display(Image(filename<span class="op">=</span><span class="st">"New folder/33.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-51-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here, I also shows the prediction of total rates with all model. For hosts, the most important thing for evaluation prediction is stay accurate though space and time, and generalizable in different context. This model has high accountability, accuracy, and generalizability through time, space, and context. What’s more, in terms of social impacts, this model didn’t overestimate the housing price in low-income or other special areas such as development promoting areas and historic protection areas, nor has higher percent error. This could avoid a systematic discrimination, and promote the benign self-improvement.</p>
<p>Here the final predictions are not limited in the range of 0-100 for this model is for prediction of a more generalizable results not a more accurate results correspond to the semi-arbitrary observed total rates. People can get information from the predicted scores about their housing’s potential, and make strategies for improving which aspects with the consideration of marginal effect. It is a user based choice that I don’t limite the range. But if I do, the model will be more accurate.</p>
<p>Low Error</p>
<div id="14173145-3539-4341-aa8e-8b93ffaad28f" class="cell" data-execution_count="80">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Variable11 <span class="op">=</span> pd.read_excel(<span class="st">"New folder/New Microsoft Excel Worksheet (9).xlsx"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Variable11</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="80">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Mean Absolute Error</th>
<th data-quarto-table-cell-role="th">Mean Absolute Percent Error</th>
<th data-quarto-table-cell-role="th">Mean Error</th>
<th data-quarto-table-cell-role="th">Mean Percent Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.294868</td>
<td>0.02572</td>
<td>5.105489e-12</td>
<td>0.00193</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>High Generalizability - Cross Validation Results</p>
<div id="73eb0de9-dfbb-4f23-a7f4-78ab71e56e2b" class="cell" data-execution_count="81">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Variable12 <span class="op">=</span> pd.read_excel(<span class="st">"New folder/New Microsoft Excel Worksheet (10).xlsx"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Variable12</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="81">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model Name</th>
<th data-quarto-table-cell-role="th">Mean MAE</th>
<th data-quarto-table-cell-role="th">SD MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Total Rates with All</td>
<td>39.42694</td>
<td>3.233626</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Noise-like Errors (GOOD!) - The generalizability in terms of geographical error distribution is stable and small. Generally speaking, the errors can be regarded as noise.</p>
<div id="107ec866-5452-4978-8702-487bdd167bcb" class="cell" data-execution_count="82">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>display(Image(filename<span class="op">=</span><span class="st">"New folder/29.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-54-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Unbiased. The model’s error level as for neighborhoods is relatively low, and doesn’t have a clustering pattern. (Mean APE by Neiborhooods)</p>
<div id="494ceebd-55d6-4ffa-89d5-4150eb49d834" class="cell" data-execution_count="83">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>display(Image(filename<span class="op">=</span><span class="st">"New folder/34.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_files/figure-html/cell-55-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>shihang-yan@outlook.com</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>